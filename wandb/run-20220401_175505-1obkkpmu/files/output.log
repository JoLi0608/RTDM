
2022-04-01 17:55:12,370	INFO services.py:1412 -- View the Ray dashboard at [32m[1mhttp://127.0.0.1:8265
[36m(ServeController pid=28420)[39m 2022-04-01 17:55:15,921	INFO checkpoint_path.py:16 -- Using RayInternalKVStore for controller checkpoint and recovery.
[36m(ServeController pid=28420)[39m 2022-04-01 17:55:16,025	INFO http_state.py:98 -- Starting HTTP proxy with name 'SERVE_CONTROLLER_ACTOR:HVGiwR:SERVE_PROXY_ACTOR-node:127.0.0.1-0' on node 'node:127.0.0.1-0' listening on '127.0.0.1:8000'
2022-04-01 17:55:16,298	INFO api.py:521 -- Started Serve instance in namespace 'serve'.
2022-04-01 17:55:16,321	INFO trainer.py:2140 -- Your framework setting is 'tf', meaning you are using static-graph mode. Set framework='tf2' to enable eager execution with tf2.x. You may also then want to set eager_tracing=True in order to reach similar execution speed as with static-graph mode.
2022-04-01 17:55:16,323	INFO ppo.py:249 -- In multi-agent mode, policies will be optimized sequentially by the multi-GPU optimizer. Consider setting simple_optimizer=True if this doesn't work for you.
2022-04-01 17:55:16,323	INFO trainer.py:779 -- Current log_level is WARN. For more information, set 'log_level': 'INFO' / 'DEBUG' or use the -v and -vv flags.
[36m(HTTPProxyActor pid=28413)[39m INFO:     Started server process [28413]
here
[36m(RolloutWorker pid=28416)[39m here
[36m(RolloutWorker pid=28415)[39m here
2022-04-01 17:55:23,443	WARNING util.py:55 -- Install gputil for GPU system monitoring.
Traceback (most recent call last):
  File "/Users/liwenyu/Documents/GitHub/RTDM/loadmodel.py", line 65, in <module>
    trainer.restore("/Users/liwenyu/Downloads/ray_results/PPO_Hopper-v2_0c9e7_00000_0_2022-03-30_13-26-47/checkpoint_004300/checkpoint-4300")
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/ray/tune/trainable.py", line 490, in restore
    self.load_checkpoint(checkpoint_path)
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/ray/rllib/agents/trainer.py", line 1861, in load_checkpoint
    self.__setstate__(extra_data)
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/ray/rllib/agents/trainer.py", line 2509, in __setstate__
    self.workers.local_worker().restore(state["worker"])
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/ray/rllib/evaluation/rollout_worker.py", line 1353, in restore
    self.policy_map[pid].set_state(state)
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/ray/rllib/policy/tf_policy.py", line 493, in set_state
    self._optimizer_variables.set_weights(optimizer_vars)
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/ray/experimental/tf_utils.py", line 182, in set_weights
    assign_list, feed_dict = self._assign_weights(new_weights)
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/ray/experimental/tf_utils.py", line 210, in _assign_weights
    print(weights[1])
IndexError: list index out of range
2022-04-01 17:55:23,453	ERROR worker.py:83 -- Unhandled error (suppress with RAY_IGNORE_UNHANDLED_ERRORS=1): [36mray::RolloutWorker.set_weights()[39m (pid=28416, ip=127.0.0.1, repr=<ray.rllib.evaluation.rollout_worker.RolloutWorker object at 0x7fe269638550>)
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/ray/rllib/evaluation/rollout_worker.py", line 1408, in set_weights
    self.policy_map[pid].set_weights(w)
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/ray/rllib/policy/tf_policy.py", line 453, in set_weights
    return self._variables.set_weights(weights)
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/ray/experimental/tf_utils.py", line 182, in set_weights
    assign_list, feed_dict = self._assign_weights(new_weights)
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/ray/experimental/tf_utils.py", line 210, in _assign_weights
    print(weights[1])
KeyError: 1
2022-04-01 17:55:23,454	ERROR worker.py:83 -- Unhandled error (suppress with RAY_IGNORE_UNHANDLED_ERRORS=1): [36mray::RolloutWorker.set_weights()[39m (pid=28415, ip=127.0.0.1, repr=<ray.rllib.evaluation.rollout_worker.RolloutWorker object at 0x7fcbe5cf8580>)
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/ray/rllib/evaluation/rollout_worker.py", line 1408, in set_weights
    self.policy_map[pid].set_weights(w)
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/ray/rllib/policy/tf_policy.py", line 453, in set_weights
    return self._variables.set_weights(weights)
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/ray/experimental/tf_utils.py", line 182, in set_weights
    assign_list, feed_dict = self._assign_weights(new_weights)
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/ray/experimental/tf_utils.py", line 210, in _assign_weights
    print(weights[1])
KeyError: 1
Traceback (most recent call last):
  File "/Users/liwenyu/Documents/GitHub/RTDM/loadmodel.py", line 65, in <module>
    trainer.restore("/Users/liwenyu/Downloads/ray_results/PPO_Hopper-v2_0c9e7_00000_0_2022-03-30_13-26-47/checkpoint_004300/checkpoint-4300")
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/ray/tune/trainable.py", line 490, in restore
    self.load_checkpoint(checkpoint_path)
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/ray/rllib/agents/trainer.py", line 1861, in load_checkpoint
    self.__setstate__(extra_data)
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/ray/rllib/agents/trainer.py", line 2509, in __setstate__
    self.workers.local_worker().restore(state["worker"])
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/ray/rllib/evaluation/rollout_worker.py", line 1353, in restore
    self.policy_map[pid].set_state(state)
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/ray/rllib/policy/tf_policy.py", line 493, in set_state
    self._optimizer_variables.set_weights(optimizer_vars)
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/ray/experimental/tf_utils.py", line 182, in set_weights
    assign_list, feed_dict = self._assign_weights(new_weights)
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/ray/experimental/tf_utils.py", line 210, in _assign_weights
    print(weights[1])
IndexError: list index out of range